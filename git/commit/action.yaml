name: 'Commit'

description: 'Commit'

inputs:
  amend:
    default: false
    description: 'Amend commit'
    required: false
    type: boolean
  message:
    default: null
    description: 'Commit message'
    required: false
    type: string
  push:
    default: false
    description: 'Push changes'
    required: false
    type: boolean
  force:
    description: 'Force push changes'
    required: false
    default: false
    type: boolean

runs:
  using: "composite"

  steps:
    - name: â³ Checking inputs
      if: ${{ (inputs.message != null || inputs.message != '') &&  inputs.amend == 'true' }}
      shell: bash
      run: |
        echo "Commit message must not be provided if amend is true"
        exit 1

    - name: ğŸ“ git config
      shell: bash
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"

    - name: ğŸª gid diff
      shell: bash
      run: |
        git diff

    - name: â• gid add
      shell: bash
      run: |
        git add .

    - name: ğŸ’¬ git commit
      if: ${{ inputs.amend == 'false' }}
      shell: bash
      run: |
        git commit -m "${{ inputs.message }}" -a

    - name: ğŸ’¬ğŸ”¨ git commit --amend
      if: ${{ inputs.amend == 'true' }}
      shell: bash
      run: |
        git commit --amend --author="GitHub Action <action@github.com>" --no-edit

    - name: â¤´ï¸ git push
      if: ${{ inputs.push == 'true' && inputs.force != 'true' }}
      shell: bash
      run: |
        git push

    - name: â¤´ï¸ğŸ”¨ git push --force
      if: ${{ inputs.push == 'true' && inputs.force == 'true' }}
      shell: bash
      run: |
        git push --force
